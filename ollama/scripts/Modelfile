FROM ../models/Devstral-Small-2507-Q4_K_M.gguf

# Template for chat completion
TEMPLATE """{{ if .System }}<|im_start|>system
{{ .System }}<|im_end|>
{{ end }}{{ if .Prompt }}<|im_start|>user
{{ .Prompt }}<|im_end|>
{{ end }}<|im_start|>assistant
"""

# Model parameters
PARAMETER temperature ${MODEL_TEMPERATURE}
PARAMETER top_p ${MODEL_TOP_P}
PARAMETER top_k ${MODEL_TOP_K}
PARAMETER repeat_penalty ${MODEL_REPEAT_PENALTY}
PARAMETER repeat_last_n ${MODEL_REPEAT_LAST_N}
PARAMETER num_ctx ${MODEL_NUM_CTX}
PARAMETER num_predict ${MODEL_NUM_PREDICT}
PARAMETER seed ${MODEL_SEED}

# Memory management - force CPU+GPU hybrid loading
PARAMETER mmap ${OLLAMA_MMAP}
PARAMETER num_gpu ${OLLAMA_GPU_LAYERS}
PARAMETER num_thread ${OLLAMA_NUM_THREAD}

# System message
SYSTEM """You are Devstral, a helpful AI assistant specialized in software development and coding tasks."""