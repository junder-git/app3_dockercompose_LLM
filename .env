# .env file - Static Implementation Configuration
# =============================================================================
# üîß CONFIGURE ME - CHANGE THESE SETTINGS BEFORE DEPLOYMENT
# =============================================================================

# Domain Configuration (REQUIRED TO CHANGE)
ALLOWED_DOMAINS=localhost,127.0.0.1,ai.junder.uk

# Admin User Configuration (REQUIRED TO CHANGE)
ADMIN_USERNAME=admin1
ADMIN_PASSWORD=admin1
ADMIN_USER_ID=admin

# Model Configuration
OLLAMA_MODEL=devstral
MODEL_DISPLAY_NAME=Devstral Small 2505
MODEL_DESCRIPTION=Devstral - Advanced coding and reasoning model (23.57B parameters)

# Performance Tuning - CONSERVATIVE for stability
OLLAMA_GPU_LAYERS=12                      # GPU layers for model
OLLAMA_CONTEXT_SIZE=512                   # Context window size
OLLAMA_BATCH_SIZE=64                      # Batch processing size
OLLAMA_NUM_THREAD=2                       # Number of threads

# User Management
MAX_CHATS_PER_USER=1                      # Maximum chats per user
MAX_PENDING_USERS=2                       # Maximum pending user registrations
RATE_LIMIT_MESSAGES_PER_MINUTE=100        # Rate limit per user

# Resource Limits
OLLAMA_MEMORY=15G                         # RAM for Ollama
OLLAMA_CPU=4                              # CPU cores for Ollama
REDIS_MEMORY=2G                           # RAM for Redis
REDIS_CPU=1                               # CPU cores for Redis
NGINX_MEMORY=1G                           # RAM for nginx
NGINX_CPU=1                               # CPU cores for nginx

# =============================================================================
# ‚ö° OLLAMA PERFORMANCE PARAMETERS
# =============================================================================
OLLAMA_HOST=0.0.0.0
OLLAMA_URL=http://ollama:11434
OLLAMA_KEEP_ALIVE=5m                      # Keep model loaded for 5 minutes
OLLAMA_MAX_LOADED_MODELS=1                # Only one model at a time
OLLAMA_LOAD_TIMEOUT=10m                   # Model load timeout
OLLAMA_NOPRUNE=1                          # Never unload models
OLLAMA_MLOCK=1                            # Lock model in RAM/VRAM
OLLAMA_MMAP=0                             # Disable memory mapping
OLLAMA_NUMA=0                             # Disable NUMA
OLLAMA_MAIN_GPU=0                         # Primary GPU ID

# =============================================================================
# üéõÔ∏è MODEL PARAMETERS
# =============================================================================
MODEL_TEMPERATURE=0.7
MODEL_TOP_P=0.9
MODEL_TOP_K=40
MODEL_REPEAT_PENALTY=1.1
MODEL_MIROSTAT=0
MODEL_MIROSTAT_ETA=0.1
MODEL_MIROSTAT_TAU=5.0
MODEL_USE_MMAP=false                      # Disable memory mapping
MODEL_USE_MLOCK=true                      # Enable memory locking
MODEL_STOP_SEQUENCES=["<|endoftext|>", "<|im_end|>", "[DONE]", "<|end|>"]

# =============================================================================
# üì± APPLICATION SETTINGS
# =============================================================================
MODEL_MAX_TOKENS=32                       # Max tokens per response
MODEL_TIMEOUT=60                          # Response timeout in seconds
CHAT_HISTORY_LIMIT=5                      # Messages to keep in history
CHAT_CACHE_TTL_SECONDS=1800               # Cache TTL (30 minutes)

# =============================================================================
# üë• USER VALIDATION SETTINGS
# =============================================================================
MIN_USERNAME_LENGTH=3
MAX_USERNAME_LENGTH=14
MIN_PASSWORD_LENGTH=5
MAX_PASSWORD_LENGTH=128
MAX_MESSAGE_LENGTH=5000                   # Max message length
MAX_FILENAME_LENGTH=255
CSRF_TOKEN_LENGTH=32

# =============================================================================
# üîí RATE LIMITING SETTINGS
# =============================================================================
RATE_LIMIT_WINDOW=60                      # Rate limit window in seconds
USER_ID_COUNTER_START=1000                # Starting ID for regular users

# =============================================================================
# üñ•Ô∏è NVIDIA GPU SETTINGS
# =============================================================================
NVIDIA_VISIBLE_DEVICES=0
CUDA_MEMORY_FRACTION=0.80                 # Use 80% of GPU memory
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# üì¶ REDIS CONFIGURATION
# =============================================================================
REDIS_URL=redis://redis:6379/0
REDIS_MAX_CONNECTIONS=25                  # Max Redis connections
REDIS_SOCKET_KEEPALIVE=true
REDIS_RETRY_ON_TIMEOUT=true
REDIS_DECODE_RESPONSES=true

# =============================================================================
# ‚è±Ô∏è TIMEOUT SETTINGS
# =============================================================================
UNLIMITED_TIMEOUT=300                     # 5 minutes for long operations
STREAMING_TIMEOUT=300                     # 5 minutes for streaming
AIOHTTP_TOTAL_TIMEOUT=300                 # Total HTTP timeout
AIOHTTP_CONNECT_TIMEOUT=30                # Connection timeout
AIOHTTP_READ_TIMEOUT=300                  # Read timeout

# =============================================================================
# üåê CLIENT-SIDE CONFIGURATION
# =============================================================================
# These settings are used by the JavaScript application
SESSION_LIFETIME_DAYS=7                   # Session lifetime in days
SSE_HEARTBEAT_INTERVAL=30                 # SSE heartbeat interval
SSE_MAX_CONNECTIONS=5                     # Max SSE connections
SSE_RETRY_TIMEOUT=5000                    # SSE retry timeout in ms