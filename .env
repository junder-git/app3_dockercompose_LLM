# CORRECTED .env - Consistent Memory Management Settings
# =============================================================================

# üîê JWT CONFIGURATION
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-min-32-chars

# Domain Configuration
ALLOWED_DOMAINS=localhost,127.0.0.1,ai.junder.uk

# Admin User Configuration
ADMIN_USERNAME=admin1
ADMIN_PASSWORD=admin1
ADMIN_USER_ID=admin

# =============================================================================
# ü§ñ MODEL CONFIGURATION
# =============================================================================
OLLAMA_MODEL=devstral
MODEL_DISPLAY_NAME=Devstral Small 2505
MODEL_DESCRIPTION=Devstral - Advanced coding and reasoning model (23.57B parameters) - Corrected Hybrid Mode

# =============================================================================
# ‚ö° CORRECTED OLLAMA SETTINGS - NO CONFLICTS
# =============================================================================
OLLAMA_HOST=0.0.0.0
OLLAMA_URL=http://ollama:11434
OLLAMA_LOAD_TIMEOUT=45m

# CORRECTED: Memory settings - NO CONFLICTS between server and model
OLLAMA_MMAP=0                            # Server: DISABLED
OLLAMA_MLOCK=1                           # Server: ENABLED
MODEL_USE_MMAP=false                     # Model: DISABLED (matches server)
MODEL_USE_MLOCK=true                     # Model: ENABLED (matches server)

# Conservative hybrid settings
OLLAMA_GPU_LAYERS=8                      # Conservative 6GB VRAM target
OLLAMA_CONTEXT_SIZE=1024                 # Reduced for stability
OLLAMA_BATCH_SIZE=64                     # Conservative batch size
OLLAMA_NUM_THREAD=6                      # Stable threading

# Resource management
OLLAMA_KEEP_ALIVE=300                    # 5 minutes (allow recovery)
OLLAMA_NOPRUNE=0                         # Allow pruning
OLLAMA_MAX_LOADED_MODELS=1               # Single model

# GPU settings
OLLAMA_GPU_MEMORY_FRACTION=0.25          # 25% = 6GB target
NVIDIA_VISIBLE_DEVICES=0

# =============================================================================
# üéõÔ∏è MODEL PARAMETERS - CONSERVATIVE
# =============================================================================
MODEL_TEMPERATURE=0.6
MODEL_TOP_P=0.9
MODEL_TOP_K=40
MODEL_REPEAT_PENALTY=1.1
MODEL_MAX_TOKENS=2048
MODEL_TIMEOUT=300

# =============================================================================
# üì± APPLICATION SETTINGS
# =============================================================================
CHAT_HISTORY_LIMIT=10
RATE_LIMIT_MESSAGES_PER_MINUTE=6
MAX_MESSAGE_LENGTH=4000

# User Management
MAX_CHATS_PER_USER=1
MAX_PENDING_USERS=2
MIN_USERNAME_LENGTH=3
MAX_USERNAME_LENGTH=14
MIN_PASSWORD_LENGTH=6
MAX_PASSWORD_LENGTH=128

# =============================================================================
# üê≥ DOCKER RESOURCES - CONSERVATIVE
# =============================================================================
OLLAMA_MEMORY=12G
OLLAMA_CPU=3
REDIS_MEMORY=1G
REDIS_CPU=1
NGINX_MEMORY=512M
NGINX_CPU=1

# =============================================================================
# üì¶ REDIS & TIMEOUTS
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_URL=redis://redis:6379/0

# Conservative timeouts
UNLIMITED_TIMEOUT=600
STREAMING_TIMEOUT=600
MODEL_TIMEOUT=300

# =============================================================================
# üìù LOGGING
# =============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json